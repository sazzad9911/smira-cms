"use strict";(self.webpackChunkpurple_react_free=self.webpackChunkpurple_react_free||[]).push([[8139],{8139:function(e,a,n){n.r(a);var r=n(885),t=n(2791),s=n(9271),l=n(2930),i=n(4912),c=n(7266),o=n(3108),d=n(184);a.default=function(){var e=(0,c.v0)(o.Z),a=(0,s.UO)().uid,n=t.useState(null),u=(0,r.Z)(n,2),m=u[0],h=u[1],p=t.useState(),f=(0,r.Z)(p,2),b=f[0],g=f[1],v=t.useState(),j=(0,r.Z)(v,2),x=j[0],N=j[1],y=t.useState(),C=(0,r.Z)(y,2),S=C[0],w=C[1],_=t.useState(),D=(0,r.Z)(_,2),Z=D[0],E=D[1],M=t.useState(),A=(0,r.Z)(M,2),k=A[0],P=A[1],q=t.useState(),H=(0,r.Z)(q,2),L=H[0],U=H[1],I=t.useState(),Q=(0,r.Z)(I,2),R=Q[0],T=Q[1];function F(e){for(var a="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,t=0;t<e;t++)a+=n.charAt(Math.floor(Math.random()*r));return a}t.useEffect((function(){(0,l.qC)(l.HQ+"/getData",{tableName:"user",condition:"uid='".concat(a,"'")}).then((function(e){if(Array.isArray(e)&&e.length>0)return e[0].membership_type?(w(e[0].membership_type),E((0,l.TJ)(e[0].starting_date)),P((0,l.TJ)(e[0].ending_date))):w("non"),h(e);console.log(e.message)}))}),[a]),t.useEffect((function(){(0,l.qC)(l.HQ+"/getData",{tableName:"membership"}).then((function(e){if(Array.isArray(e)&&e.length>0)return U(e.filter((function(e){return e.type==S}))[0]),T(e.filter((function(e){return e.type==S}))[0]),N(e);console.log(e.message)}))}));return(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"page-header",children:[(0,d.jsx)("h3",{className:"page-title",children:" Change Membership Plan "}),(0,d.jsx)("nav",{"aria-label":"breadcrumb",children:(0,d.jsxs)("ol",{className:"breadcrumb",children:[(0,d.jsx)("li",{className:"breadcrumb-item",children:(0,d.jsx)("a",{href:"!#",onClick:function(e){return e.preventDefault()},children:"Plans"})}),(0,d.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Add"})]})})]}),(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-12 grid-margin",children:(0,d.jsx)("div",{className:"card",children:(0,d.jsxs)("div",{className:"card-body",children:[(0,d.jsx)("h4",{className:"card-title",children:"Information"}),(0,d.jsxs)("form",{className:"form-sample",children:[(0,d.jsx)("p",{className:"card-description",children:"Edit plans and offer "}),(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-md-6",children:(0,d.jsxs)(i.Z.Group,{className:"row",children:[(0,d.jsx)("label",{className:"col-sm-3 col-form-label",children:"Select Plan"}),(0,d.jsx)("div",{className:"col-sm-9",children:(0,d.jsxs)("select",{value:S,onChange:function(e){U(x.filter((function(a){return a.type==e.target.value}))[0]),w(e.target.value)},className:"form-control",children:[(0,d.jsx)("option",{value:"non",children:"Non Member"}),x?x.map((function(e,a){return(0,d.jsx)("option",{value:e.type,children:e.name},a)})):(0,d.jsx)("option",{children:"Select one"})]})})]})})}),"non"!=S?(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-md-6",children:(0,d.jsxs)(i.Z.Group,{className:"row",children:[(0,d.jsx)("label",{className:"col-sm-3 col-form-label",children:"Starting Date"}),(0,d.jsx)("div",{className:"col-sm-9",children:(0,d.jsx)(i.Z.Control,{value:Z,onChange:function(e){return E(e.target.value)},placeholder:"",type:"date"})})]})}),(0,d.jsx)("div",{className:"col-md-6",children:(0,d.jsxs)(i.Z.Group,{className:"row",children:[(0,d.jsx)("label",{className:"col-sm-3 col-form-label",children:"Ending Date"}),(0,d.jsx)("div",{className:"col-sm-9",children:(0,d.jsx)(i.Z.Control,{value:k,onChange:function(e){return P(e.target.value)},placeholder:"",type:"date"})})]})})]}):(0,d.jsx)(d.Fragment,{}),b?(0,d.jsx)("div",{className:"alert alert-primary",role:"alert",children:b}):(0,d.jsx)(d.Fragment,{})]}),(0,d.jsx)("button",{onClick:function(){if(x)if(S)if("non"==S)(0,l.qC)(l.HQ+"/query",{query:"UPDATE user SET membership_type=NULL,starting_date=NULL,ending_date=NULL WHERE uid='".concat(a,"'")}).then((function(e){if(e.affectedRows)return g("Membership plan change successfully completed");g(e.message),console.log(e)}));else{if(!L)return void g("Invalid membership");if(!Z||!k)return void g("Please select a starting or ending date.");if((0,l.ri)(Z,k)<0)return void g("Invalid! Starting date must be previous from ending date");if(g("Please wait..."),(0,l.qC)(l.HQ+"/updateData",{auth:e.currentUser,tableName:"user",columns:["membership_type","starting_date","ending_date","paid"],values:[S,(0,l.cR)(new Date(Z)),(0,l.cR)(new Date(k)),""],condition:"uid='".concat(a,"'")}).then((function(e){if(e.affectedRows)return g("Membership plan change successfully completed");g(e.message)})),L==R)return;var n=null;if("no"!=L.account)for(var r=parseInt(L.account),t=0;t<r;){var s=F(16);n=n?n+", '"+s+"'":"'"+s+"'",(0,l.qC)(l.HQ+"/setData",{auth:e.currentUser,tableName:"family_code",columns:["code","buyer_id"],values:[s,a]}).then((function(e){console.log(e)})),t++}var i=n?"Your Family Access Code is ".concat(n," (If applicable)"):"";(0,l.qC)(l.HQ+"/sendEmail",{from:"info@smira.club",to:m[0].email,subject:"You\u2019re now officially a member of our family - Smira Club",text:"\n              <p>Dear <strong>".concat(m[0].name,"</strong>,</p>\n              <p>Welcome to Smira Club. We\u2019re thrilled to see you here!</p>\n              <p>Congratulations! <br>\n              Membership Type:<strong> ").concat(L.name," </strong><br>\n              Total Days: <strong>").concat((0,l.ri)(Z,k)," </strong><br>\n              <p>We\u2019re confident that membership will help you save more money while enjoying the luxuries of our services. </p>\n              <p>").concat(i,"</p>\n              <p>Best regards, <br>\n                Smira Club</p>\n\n              <b>Smira Services - \u2018A sweet memory is really affordable\u2019 </b>\n\n\n              <p><b>Smira Sevices Pvt. Ltd. </b><br>\n             Ranjit Studio Compound, <br>\n              Ground & 1st Floor, <br>\n              M-Block, Plot No. 115, <br>\n              Dada Saheb Phalke Marg, <br>\n              Opp. Bharatkshetra, Hindmata, <br>\n              Dadar East, Mumbai, <br>\n              Maharashtra 400014 </p>\n\n              <p><b>Contact No. </b><br>\n              9833733477<br>\n              9833733977<br>\n              Email - support@smira.club</p>\n              ")}).then((function(e){console.log(e)}))}else g("Invalid selection.");else g("Error loading membership plans")},className:"btn btn-gradient-secondary btn-rounded btn-fw",children:"SAVE"})]})})})})]})}}}]);
//# sourceMappingURL=8139.9ac2a1ab.chunk.js.map